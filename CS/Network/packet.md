# Packet

---

- 패킷이란 컴퓨터 네트워크가 전달하는 데이터의 형식화된 블록이다.
- 컴퓨터 네트워크에서 데이터를 주고받을 때 정해놓은 규칙
- 정보를 보낼 때 특정 형태를 맞추어 보낸다.
- 컴퓨터 간에 데이터를 주고받을 때 네트워크를 통해서 전송되는 데이터 조각
- 커다란 데이터를 한 번에 보내게 되면 대역폭을 많이 차지하기 때문에, 패킷의 흐름을 원활하게 하지 못합니다.
    - 도로가 4차선인데, 하나의 차가 2차선을 이용하는 상황
    - 대역폭 : 신호를 전송할 수 있는 주파수 범위 또는 폭

## 패킷 교환 방식

---

- 따라서 큰 사진 하나를 전송할 때에도, 작은 패킷으로 분할하고 전송합니다.
- 그리고 작은 패킷들로 분할된 사진은 상대방에게 전달될 때 번호를 붙여서 전달이 됩니다.
- 이러한 방식을 패킷 교환 방식이라 합니다.

## 패킷의 구조

---

- 버전
    - 사용 중인 IP 버전을 식별하는데 사용됩니다.
    - 버전 4 또는 버전 6 중 하나만 선택할 수 있습니다.
- TTL (Time to Live)
    - 패킷이 네트워크에 남아있을 수 있는 시간입니다.
    - 패킷을 처리하는 각 라우터는 이 카운터를 하나 이상 감소시킵니다.
- 프로토콜
    - IP 패킷의 데이터 부분이 전달되는 계층 프로토콜입니다.
    - TCP (Transmission Control Portocol) 또는 UDP (User Datagram Protocol) 입니다.
- 헤더체크섬
    - 검증 계산의 기반이 되는 헤더 체크섬 데이터는 헤더 데이터일 뿐이며, 해당 계산 겨로가는 헤더 체크섬 필드에 저장됩니다.
    - 헤더가 손상되지 않은 경우 IP 는 패킷이 양호하다고 간주합니다.
- 소스 주소
    - 패킷을 네트워크로 보내는 장치의 IP 주소입니다.
    - ICMP (Internet Control Message Protocol) 전송실패 또는 제어 메시지를 포함하여 네트워크 수준 오류 메시지가 전송되는 곳입니다.
- 대상 주소
    - 패킷이 전송되는 주소입니다.
- 데이터
    - 이더넷 프레임과 마찬가지로 데이터 부분이 전송 계층, TCP 또는 UDP 로 전송됩니다.

## Packet 의 최대 전송길이

---

- 패킷의 최대 전송 길이는 네트워크 프로토콜마다 각 다르다.
    - 이더넷 (Ethernet) : 유선 네트워크 기술, 이더넷 프레임의 최대 크기는 1,500 바이트
    - 인터넷 프로토콜 (IP) : IP 프로토콜은 IPv$ 에서 최대 크기가 65,535 바이트
    - TCP (Transmission Control Protocol) : TCP 는 연결지향 프로토콜
        - TCP 세그먼트의 최대 크기는 IP 패킷의 크기에 따라 결정됨
        - 이더넷 MTU 인 1,500 바이트로 제한됨
    - UDP (User Datagram Protocol) : UDP 는 비연결성 프로토콜
        - UDP 의 최대 패킷 크기는 IP 패킷 크기인 65,535 바이트로 제한됨

## MTU

---

- Maximum Transmission Unit
- 하나의 프레임이나 패킷이 한번에 전송가능한 데이터의 크기
- IP 구조체의 전체 패킷 크기를 지정하는 필드가 16비트로 되어 있어, TCP 헤더 (20바이트) , IP 헤더 (20바이트) 를 제외한 65495 바이트까지 가능하다.
- TCP 가 한번에 전송하는 메시지의 크기를 MSS (Maximum Segment Size) 라고 하며, 초기에 상대방 TCP 에게 알려주는데, TCP 는 전송할 데이터가 이보다 클 경우 데이터를 MSS 사이즈로 세분화하여 전송한다.
- TCP 프로토콜은 분할된 패킷을 수신 측에서 다시 조립하여 원래의 데이터로 복원합니다.

## HTTP Byte Offset

---

- Http Byte Offset 은 HTTP Range 요청에서 사용되느 ㄴ개념
- HTTP Range 요청은 웹서버로부터 파일의 특정 범위 또는 부분만을 요청하는 것을 의미
- Byte Offset 은 이러한 요청에서 가져와야하는 파일의 시작 위치를 나타내는 값
- Byte Offset 사용
    - 일반적으로 Range 헤더를 사용하여 클라이언트가 서버에 전달
    - `Range` 헤더의 값은 `bytes=<start>-<end>` 형식으로 지정
        - <start> 는 파일의 시작 위치 또는 Byte Offset 을 나타냄
        - <end> 는 파일의 끝 위치를 나타냄
        - <start> 와 <end> 는 바이트 단위로 지정됨
    - Range: bytes=100-199 는 파일의 100번째 바이트부터 199번째 바이트까지의 범위를 요청하는 것을 의미
- Byte Offset 을 사용하여 HTTP Range 요청을 통해 파일의 특정 부분만을 요청할 수 있으므로, 대용량 파일의 일부분만을 필요로 할 때 유용

## WebSocket

---

- WebSocket 프로토콜 자체는 패킷 크기에 대한 명시적인 제한을 두지 않음
- WebSocket 은 TCP 프로토콜 위에서 동작하며, TCP 프로토콜은 IP 패킷의 최대 크기에 따라 데이터를 분할하고 재조립함
- 일반적으로 TCP/IP 프로토콜에서는 이더넷 프레임의 최대 크기인 1500 바이트를 넘는 데이터를 전송할 때 IP 패킷을 분할하여 전송함

# Reference

---

- https://enlqn1010.tistory.com/9