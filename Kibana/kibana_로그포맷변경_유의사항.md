
# Kibnana 로 수집되는 로그 포맷이 변경될 때

---

- Kibnana 는 Elasticsearch 와 함께 사용되는 로그 분석 및 시각화 도구
- Kibana 에서 로그를 수집하는 경우 Elasticsearch 에 저장된 로그를 가져오는 것
- 로그 수집 포맷이 변경된 경우 Elasticsearch 에 저장된 이전 로그의 데이터 형식과 호환되지 않을 수 있음



- 다음과 같은 작업이 필요
    - 로그 수집 포맷 변경 시 Elasticsearch 에 새로운 인덱스를 생성하여 새로운 로그를 수집, 기존의 인덱스와 함께 새로운 인덱스를 동시에 사용하여 데이터 유실을 방지
    - 기존의 인덱스에서 필드를 추가하거나 변경할 수 있습니다. Elasticsearch 에서 제공하는 업그레이드 도구를 사용하여 새로운 필드를 추가하거나 필드 유형을 변경할 수 있습니다.
    - 새로운 로그 수집 포맷이 완전히 다른 경우, Elasticsearch 의 인덱스를 삭제하고, 새로운 인덱스를 생성하여 로그를 수집해야 할 수 있습니다. 이 경우, 수집된 로그 데이터는 모두 삭제됩니다.


- 이전 로그의 데이터 형식과 호환되지 않는 새로운 로그 수집 포맷을 사용하는 경우 다음과 같은 문제 발생 
  - 데이터 손실: Elasticsearch는 데이터를 인덱싱하고 검색하는 데 사용되는 스키마가 있습니다. 새로운 로그 수집 포맷이 이전 로그와 호환되지 않는 경우 Elasticsearch는 이전 로그를 새로운 포맷으로 인덱싱할 수 없으므로 이전 로그 데이터가 손실될 수 있습니다. 
  - 검색 불가: Elasticsearch에서 제공하는 검색 기능은 색인된 데이터에 의존합니다. 만약 이전 로그 데이터가 새로운 포맷으로 인덱싱되지 않았다면, 이전 로그 데이터를 검색할 수 없게 됩니다. 
  - 시각화 불가: Kibana는 Elasticsearch에서 데이터를 가져와 시각화하는 도구입니다. 이전 로그 데이터가 새로운 포맷으로 인덱싱되지 않은 경우 Kibana에서 이전 로그 데이터를 시각화할 수 없습니다.



- 로그 포맷이 변경된 것 중에는 심각한 영향을 미칠 수 있는 경우 
  - 필드 유형 변경: 필드 유형이 변경되는 경우 Elasticsearch에서는 해당 필드의 데이터 유형을 변경해야 합니다. 예를 들어, 이전 로그에서는 문자열로 저장되던 필드가 새로운 로그에서는 숫자로 저장되어야 한다면, Elasticsearch에서는 이전 데이터를 삭제하고 새로운 데이터 유형에 맞게 재색인해야 합니다. 
  - 필드 삭제: 필드가 삭제되는 경우 Elasticsearch에서 해당 필드를 사용하여 수행한 분석이 영향을 받을 수 있습니다. 예를 들어, 삭제된 필드를 사용하여 생성한 대시보드나 시각화는 더 이상 작동하지 않을 수 있습니다. 
  - 필드 추가: 필드가 추가되면 Elasticsearch에서 해당 필드를 색인하고 분석해야 합니다. 그러나 새로운 필드가 추가되었을 때 필요한 작업이 많지 않은 경우도 있습니다. 
  - 데이터 구조 변경: 데이터 구조가 변경되는 경우 Elasticsearch에서는 이전 데이터를 삭제하고 새로운 데이터 구조에 맞게 데이터를 재색인해야 합니다. 예를 들어, 이전 로그에서는 JSON 형식으로 저장되던 데이터가 새로운 로그에서는 CSV 형식으로 저장된다면, Elasticsearch에서는 이전 데이터를 삭제하고 CSV 형식에 맞게 데이터를 다시 색인해야 합니다.